<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>Azero</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta property="og:type" content="website">
<meta property="og:title" content="Azero">
<meta property="og:url" content="http://blog.azero-ng.cn/index.html">
<meta property="og:site_name" content="Azero">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://blog.azero-ng.cn/images/og_image.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Azero">
<meta name="twitter:image" content="http://blog.azero-ng.cn/images/og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/5.8.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-139321744-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-139321744-1');
</script>


    
    
<script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?b284b6877fba633fb045afc7f2d9dd0d";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>

    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="Azero" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active" href="/">主页</a>
                
                <a class="navbar-item" href="/archives">Archives</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/tags">Tags</a>
                
                <a class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-05-06T13:43:38.000Z">2019-05-06</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/开发/">开发</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/开发/git/">git</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 分钟 读完 (大约 237 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/git-pre-commit.html">git_pre_commit</a>
            
        </h1>
        <div class="content">
            <h1 id="git-pre-commit-钩子在HEXO的使用"><a href="#git-pre-commit-钩子在HEXO的使用" class="headerlink" title="git pre commit 钩子在HEXO的使用"></a>git pre commit 钩子在HEXO的使用</h1><h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── public</span><br><span class="line">├── source</span><br><span class="line">└── themes</span><br><span class="line">    ├── icarus</span><br><span class="line">    │   └── _config.yml</span><br><span class="line">    └── icarus.yml</span><br></pre></td></tr></table></figure>
<p>hexo 目录结构如上,hexo 根目录已初始化为git项目,icarus为子模块.出于更新,pull考虑,<strong>icarus</strong>项目没有把icarus</p>
<p>的配置文件_config.yml放到git中.但是由于icarus为子模块,所以主模块也无法add icarus的配置文件.但是为了保存icarus的配置文件,我们必须要添加到git中,以方便同步和备份</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><ol>
<li><p>在theme目录下备份 _config.yml 为icarus.yml</p>
</li>
<li><p>添加pre commit hook</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#</span><span class="hljs-bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line">if ! diff themes/icarus.yml themes/icarus/_config.yml &amp;&gt; /dev/null ; </span><br><span class="line">then</span><br><span class="line">    cp themes/icarus/_config.yml themes/icarus.yml</span><br><span class="line">    git add themes/icarus.yml</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<p>每次commit的时候都会检查_config.yml是否改变,改变则更新icarus.yml 并add</p>
</li>
<li><p>最终每次commit都可以保证配置文件的更新</p>
</li>
</ol>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-04-30T12:05:58.000Z">2019-04-30</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/linux/">linux</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    8 分钟 读完 (大约 1132 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/archlinux-transparent-proxy.html">archlinux_transparent_proxy</a>
            
        </h1>
        <div class="content">
            <h1 id="Arch-linux-v2ray-透明代理"><a href="#Arch-linux-v2ray-透明代理" class="headerlink" title="Arch linux v2ray 透明代理"></a>Arch linux v2ray 透明代理</h1><p>本文适用对象:PC翻墙(和网关翻墙相对),linux系统,v2ray</p>
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ol>
<li>linux系统全局走代理,而不仅仅是浏览器,这样git,pip,wget,telegram等等都能得到加速</li>
</ol>
<h2 id="总体框架"><a href="#总体框架" class="headerlink" title="总体框架"></a>总体框架</h2><p>服务端: nginx+v2ray</p>
<p>客户端: iptables+dnsmasq+v2ray</p>
<p>协议: WebSocket+TLS+Web(伪装能力MAX)</p>
<h2 id="服务器配置-看官方文档-不是本文重点-以后可能会写"><a href="#服务器配置-看官方文档-不是本文重点-以后可能会写" class="headerlink" title="服务器配置,看官方文档,不是本文重点,以后可能会写"></a>服务器配置,看官方文档,不是本文重点,以后可能会写</h2><h2 id="透明代理配置"><a href="#透明代理配置" class="headerlink" title="透明代理配置"></a>透明代理配置</h2><h3 id="v2ray-inbounds配置"><a href="#v2ray-inbounds配置" class="headerlink" title="v2ray inbounds配置"></a>v2ray inbounds配置</h3><ol>
<li>port:v2ray为iptables监听的端口,iptables的流量会转到这来</li>
</ol>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"port"</span>: <span class="hljs-number">12345</span>,</span><br><span class="line">  <span class="hljs-attr">"listen"</span>: <span class="hljs-string">"127.0.0.1"</span>,</span><br><span class="line">  <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"dokodemo-door"</span>,</span><br><span class="line">  <span class="hljs-attr">"settings"</span>: &#123;</span><br><span class="line">    <span class="hljs-attr">"network"</span>: <span class="hljs-string">"tcp,udp"</span>,</span><br><span class="line">    <span class="hljs-attr">"followRedirect"</span>: <span class="hljs-literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-attr">"sniffing"</span>: &#123;</span><br><span class="line">    <span class="hljs-attr">"enabled"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-attr">"destOverride"</span>: [<span class="hljs-string">"http"</span>, <span class="hljs-string">"tls"</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="v2ray-路由配置"><a href="#v2ray-路由配置" class="headerlink" title="v2ray 路由配置"></a>v2ray 路由配置</h3><figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">"routing": &#123;</span><br><span class="line">   "domainStrategy": "IPIfNonMatch",</span><br><span class="line">   "rules": [</span><br><span class="line">     &#123;//dns协议走dns-out出,下文dns配置会用到</span><br><span class="line">       "type": "field",</span><br><span class="line">       "inboundTag": ["dns-in"],</span><br><span class="line">       "outboundTag": "dns-out"</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;//外网dns走代理,防污染</span><br><span class="line">       "type": "field",</span><br><span class="line">       "outboundTag": "proxy",</span><br><span class="line">       "ip": [</span><br><span class="line">         "1.1.1.1",</span><br><span class="line">         <span class="hljs-string">"8.8.8.8"</span></span><br><span class="line">       ]</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;//广告域名屏蔽,ps:有部分域名误判</span><br><span class="line">       "type": "field",</span><br><span class="line">       "domain": ["geosite:category-ads"],</span><br><span class="line">       "outboundTag": "blocked"</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;//国内域名直连</span><br><span class="line">       "type": "field",</span><br><span class="line">       "outboundTag": "direct",</span><br><span class="line">       "domain": ["geosite:cn"]</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;//国内ip直连</span><br><span class="line">       "type": "field",</span><br><span class="line">       "outboundTag": "direct",</span><br><span class="line">       "ip": [</span><br><span class="line">         "geoip:cn",</span><br><span class="line">         <span class="hljs-string">"geoip:private"</span></span><br><span class="line">       ]</span><br><span class="line">     &#125;</span><br><span class="line">   ],</span><br><span class="line">   "strategy": "rules"</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
<h3 id="V2ray-outbounds配置"><a href="#V2ray-outbounds配置" class="headerlink" title="V2ray outbounds配置"></a>V2ray outbounds配置</h3><ol>
<li><p>在所有的outbounds中的”streamSettings”添加</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">"sockopt": &#123;</span><br><span class="line">  "mark": 255  //这里是 SO_MARK，用于 iptables 识别，每个 outbound 都要配置；255可以改成其他数值，但要与下面的 iptables 规则对应；如果有多个 outbound，最好奖所有 outbound 的 SO_MARK 都设置成一样的数值</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="iptables设置"><a href="#iptables设置" class="headerlink" title="iptables设置"></a>iptables设置</h3><ol>
<li><p>网关设备开启 IP 转发。在 /etc/sysctl.conf 文件添加一行 net.ipv4.ip_forward=1 ，执行下列命令生效：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -p</span><br></pre></td></tr></table></figure>
</li>
<li><p>设定 TCP 透明代理的 iptables 规则，命令如下(<code>#</code>代表注释)：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">iptables -t nat -N V2RAY # 新建一个名为 V2RAY 的链</span><br><span class="line">iptables -t nat -A V2RAY -d 127.0.0.1/32 -j RETURN</span><br><span class="line">iptables -t nat -A V2RAY -d 192.168.0.0/16 -j RETURN # 直连 192.168.0.0/16 </span><br><span class="line">iptables -t nat -A V2RAY -p tcp -j RETURN -m mark --mark 0xff # 直连 SO_MARK 为 0xff 的流量(0xff 是 16 进制数，数值上等同与上面配置的 255)，此规则目的是避免代理本机(网关)流量出现回环问题</span><br><span class="line">iptables -t nat -A V2RAY -p tcp -j REDIRECT --to-ports 12345 # 其余流量转发到 12345 端口（即 V2Ray）</span><br><span class="line">iptables -t nat -A OUTPUT -p tcp -j V2RAY # 对本机进行透明代理</span><br></pre></td></tr></table></figure>
</li>
<li><p>不建议设置udp全局代理,我个人目前还没有遇到需要udp代理的情况,但是开启udp代理可能会对本机造成一些影响</p>
<ol>
<li>docker node dns解析失败(待验证,目前知道的情况是 docker也用到了iptables可能和v2ray的udp全局产生了冲突)</li>
</ol>
</li>
</ol>
<h3 id="至此本机应该可以实现透明代理了-但是dns解析还有问题"><a href="#至此本机应该可以实现透明代理了-但是dns解析还有问题" class="headerlink" title="至此本机应该可以实现透明代理了,但是dns解析还有问题"></a>至此本机应该可以实现透明代理了,但是dns解析还有问题</h3><h2 id="DNS配置"><a href="#DNS配置" class="headerlink" title="DNS配置"></a>DNS配置</h2><p>由于dns污染的存在,即使ip可以透明代理,本机也无法正常上网.</p>
<h3 id="v2ray-inbounds-添加dns接口"><a href="#v2ray-inbounds-添加dns接口" class="headerlink" title="v2ray inbounds 添加dns接口"></a>v2ray inbounds 添加dns接口</h3><p>至于每个配置到底是啥意思,请看官方文档,官方文档写的非常不错</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">      "port": 54,//端口可以填53,直接把v2ray作为dns解析,但是v2ray dns存在缺点,所以为了和dnsmasq配合,使用了54端口</span><br><span class="line">      "tag": "dns-in",</span><br><span class="line">      "protocol": "dokodemo-door",</span><br><span class="line">      "settings": &#123;</span><br><span class="line">        "address": "1.1.1.1",</span><br><span class="line">        "port": 53,</span><br><span class="line">        "network": "tcp,udp"</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="v2ray-outbounds-添加dns出口"><a href="#v2ray-outbounds-添加dns出口" class="headerlink" title="v2ray outbounds 添加dns出口"></a>v2ray outbounds 添加dns出口</h3><figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="hljs-attr">"tag"</span>: <span class="hljs-string">"dns-out"</span>,</span><br><span class="line">   <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"dns"</span>,</span><br><span class="line">   <span class="hljs-attr">"settings"</span>: &#123;</span><br><span class="line">     <span class="hljs-attr">"network"</span>: <span class="hljs-string">"tcp"</span>,</span><br><span class="line">     <span class="hljs-attr">"address"</span>: <span class="hljs-string">"1.1.1.1"</span>,</span><br><span class="line">     <span class="hljs-attr">"port"</span>: <span class="hljs-number">53</span></span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="v2ray-dns模块"><a href="#v2ray-dns模块" class="headerlink" title="v2ray dns模块"></a>v2ray dns模块</h3><figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  "dns": &#123;</span><br><span class="line">    "hosts": &#123;//hosts</span><br><span class="line">      "domain:v2ray.com": "www.vicemc.net",</span><br><span class="line">      "domain:github.io": "pages.github.com",</span><br><span class="line">      "domain:wikipedia.org": "www.wikimedia.org",</span><br><span class="line">      "domain:shadowsocks.org": "electronicsrealm.com"</span><br><span class="line">    &#125;,</span><br><span class="line">    "servers": [</span><br><span class="line">      "1.1.1.1",</span><br><span class="line">      &#123;//国内域名走114</span><br><span class="line">        "address": "114.114.114.114",</span><br><span class="line">        "port": 53,</span><br><span class="line">        "domains": [</span><br><span class="line">          <span class="hljs-string">"geosite:cn"</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      "8.8.8.8",</span><br><span class="line">      <span class="hljs-string">"localhost"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  "policy": &#123;</span><br><span class="line">    "levels": &#123;</span><br><span class="line">      "0": &#123;</span><br><span class="line">        "uplinkOnly": 0,</span><br><span class="line">        "downlinkOnly": 0</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    "system": &#123;</span><br><span class="line">      "statsInboundUplink": false,</span><br><span class="line">      "statsInboundDownlink": false</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "other": &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="至此dns已经可以用了"><a href="#至此dns已经可以用了" class="headerlink" title="至此dns已经可以用了"></a>至此dns已经可以用了</h3><p>到这,dns污染问题已经解决了,可以通过如下命令检测</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig @127.0.0.1 -p 54 www.google.com</span><br></pre></td></tr></table></figure>
<p>但是正如v2ray文档所言,v2ray 内建dns支持A,AAAA方式的域名,所以会出现部分域名无法解析的情况</p>
<p>下面的这个域名采用soa方式,v2ray就无法解析了,两条命令的结果对比一下就可以看到了</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dig @8.8.8.8 gowdb.in</span><br><span class="line">dig @127.0.0.1 -p 54 gowdb.in</span><br></pre></td></tr></table></figure>
<p>下面就要dnsmasq出场了,其实v2ray可以把dns再完善完善,这样就v2ray就完美了.有志青年们可以搞搞go啊,完善v2ray,再弄个kunlikunli,嘿嘿嘿嘿.</p>
<h3 id="dnsmasq出场"><a href="#dnsmasq出场" class="headerlink" title="dnsmasq出场"></a>dnsmasq出场</h3><p>总体设想:dnsmasq,gfw域名走v2ray解析,其他域名走114</p>
<p>引入轮子:<a href="https://github.com/cokebar/gfwlist2dnsmasq" target="_blank" rel="noopener">https://github.com/cokebar/gfwlist2dnsmasq</a></p>
<figure class="highlight sh hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#别想着复制代码,自己clone下来,执行</span></span><br><span class="line"><span class="hljs-comment">#/etc/dnsmasq.d 没有这个文件夹的</span></span><br><span class="line"><span class="hljs-comment">#sudo mkdir /etc/dnsmasq.d</span></span><br><span class="line">sudo sh gfwlist2dnsmasq.sh -d 127.0.0.1 -p 54 -o /etc/dnsmasq.d/gfw.conf</span><br></pre></td></tr></table></figure>
<p>接着在/etc/dnsmasq.conf最后添加</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server=117.50.11.11</span><br><span class="line">server=117.50.22.22</span><br><span class="line">conf-dir=/etc/dnsmasq.d</span><br></pre></td></tr></table></figure>
<p>server可以填自己喜欢的dns</p>
<p>至此 dns已经完美了</p>

        </div>
        
        
        
    </div>
</div>








</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <figure class="image is-128x128 has-mb-6">
                            <img class="is-rounded" src="https://i.loli.net/2019/04/30/5cc804c7bfca7.jpg" alt="Azero">
                        </figure>
                    
                    
                    <p class="is-size-4 is-block">
                        Azero
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        ctf 选手
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>北京</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        2
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        3
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        0
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/Azero-ng" target="_blank">
                关注我</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="https://github.com/ppoffice">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/linux/">
            <span class="level-start">
                <span class="level-item">linux</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/开发/">
            <span class="level-start">
                <span class="level-item">开发</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/开发/git/">
            <span class="level-start">
                <span class="level-item">git</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
    
        
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/git-pre-commit.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="git_pre_commit">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-05-06T13:43:38.000Z">2019-05-06</time></div>
                    <a href="/git-pre-commit.html" class="has-link-black-ter is-size-6">git_pre_commit</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/开发/">开发</a> / <a class="has-link-grey -link" href="/categories/开发/git/">git</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/archlinux-transparent-proxy.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="archlinux_transparent_proxy">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-04-30T12:05:58.000Z">2019-04-30</time></div>
                    <a href="/archlinux-transparent-proxy.html" class="has-link-black-ter is-size-6">archlinux_transparent_proxy</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/linux/">linux</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/git-pre-commit.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="git_pre_commit">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-05-06T13:43:38.000Z">2019-05-06</time></div>
                    <a href="/git-pre-commit.html" class="has-link-black-ter is-size-6">git_pre_commit</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/开发/">开发</a> / <a class="has-link-grey -link" href="/categories/开发/git/">git</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/archlinux-transparent-proxy.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="archlinux_transparent_proxy">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-04-30T12:05:58.000Z">2019-04-30</time></div>
                    <a href="/archlinux-transparent-proxy.html" class="has-link-black-ter is-size-6">archlinux_transparent_proxy</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/linux/">linux</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="Azero" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 Azero&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>